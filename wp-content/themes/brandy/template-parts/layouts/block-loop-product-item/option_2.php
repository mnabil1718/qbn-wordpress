<?php

if ( ! defined( 'ABSPATH' ) ) {
	return;
}

if ( empty( $product ) ) {
	return;
}

$show_image      = isset( $display_settings['show_image'] ) ? $display_settings['show_image'] : true;
$show_title      = isset( $display_settings['show_title'] ) ? $display_settings['show_title'] : true;
$show_button     = isset( $display_settings['show_button'] ) ? $display_settings['show_button'] : true;
$show_price      = isset( $display_settings['show_price'] ) ? $display_settings['show_price'] : true;
$show_category   = isset( $display_settings['show_category'] ) ? $display_settings['show_category'] : true;
$show_sale_flash = isset( $display_settings['show_sale_flash'] ) ? $display_settings['show_sale_flash'] : true;
$show_rating     = isset( $display_settings['show_rating'] ) ? $display_settings['show_rating'] : true;

?>

<li <?php brandy_wc_loop_product_item_attributes( $product ); ?>>
	<?php
	if ( ! empty( $show_image ) ) :
		?>
	<div class="brandy-loop-product__image">
		<a href="<?php echo esc_url( $product->get_permalink() ); ?>"><?php echo $product->get_image( 'woocommerce_thumbnail' ); ?></a>
		<?php if ( ! empty( $show_button ) ) : ?>
			<?php
			echo \brandy_get_wc_add_to_cart_button(
				$product,
				array(
					'quantity' => 1,
					'is_ajax'  => true,
					'icon'     => 'variable' === $product->get_type()
						? '<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2 1.5H5C5.13261 1.5 5.25979 1.55268 5.35355 1.64645C5.44732 1.74021 5.5 1.86739 5.5 2V5C5.5 5.13261 5.44732 5.25979 5.35355 5.35355C5.25979 5.44732 5.13261 5.5 5 5.5H2C1.86739 5.5 1.74021 5.44732 1.64645 5.35355C1.55268 5.25979 1.5 5.13261 1.5 5V2C1.5 1.86739 1.55268 1.74021 1.64645 1.64645C1.74021 1.55268 1.86739 1.5 2 1.5ZM0 2C0 1.46957 0.210714 0.960859 0.585786 0.585786C0.960859 0.210714 1.46957 0 2 0H5C5.53043 0 6.03914 0.210714 6.41421 0.585786C6.78929 0.960859 7 1.46957 7 2V5C7 5.53043 6.78929 6.03914 6.41421 6.41421C6.03914 6.78929 5.53043 7 5 7H2C1.46957 7 0.960859 6.78929 0.585786 6.41421C0.210714 6.03914 0 5.53043 0 5V2ZM11 1.5H14C14.1326 1.5 14.2598 1.55268 14.3536 1.64645C14.4473 1.74021 14.5 1.86739 14.5 2V5C14.5 5.13261 14.4473 5.25979 14.3536 5.35355C14.2598 5.44732 14.1326 5.5 14 5.5H11C10.8674 5.5 10.7402 5.44732 10.6464 5.35355C10.5527 5.25979 10.5 5.13261 10.5 5V2C10.5 1.86739 10.5527 1.74021 10.6464 1.64645C10.7402 1.55268 10.8674 1.5 11 1.5ZM9 2C9 1.46957 9.21071 0.960859 9.58579 0.585786C9.96086 0.210714 10.4696 0 11 0H14C14.5304 0 15.0391 0.210714 15.4142 0.585786C15.7893 0.960859 16 1.46957 16 2V5C16 5.53043 15.7893 6.03914 15.4142 6.41421C15.0391 6.78929 14.5304 7 14 7H11C10.4696 7 9.96086 6.78929 9.58579 6.41421C9.21071 6.03914 9 5.53043 9 5V2ZM14 10.5H11C10.8674 10.5 10.7402 10.5527 10.6464 10.6464C10.5527 10.7402 10.5 10.8674 10.5 11V14C10.5 14.1326 10.5527 14.2598 10.6464 14.3536C10.7402 14.4473 10.8674 14.5 11 14.5H14C14.1326 14.5 14.2598 14.4473 14.3536 14.3536C14.4473 14.2598 14.5 14.1326 14.5 14V11C14.5 10.8674 14.4473 10.7402 14.3536 10.6464C14.2598 10.5527 14.1326 10.5 14 10.5ZM11 9C10.4696 9 9.96086 9.21071 9.58579 9.58579C9.21071 9.96086 9 10.4696 9 11V14C9 14.5304 9.21071 15.0391 9.58579 15.4142C9.96086 15.7893 10.4696 16 11 16H14C14.5304 16 15.0391 15.7893 15.4142 15.4142C15.7893 15.0391 16 14.5304 16 14V11C16 10.4696 15.7893 9.96086 15.4142 9.58579C15.0391 9.21071 14.5304 9 14 9H11ZM2 10.5H5C5.13261 10.5 5.25979 10.5527 5.35355 10.6464C5.44732 10.7402 5.5 10.8674 5.5 11V14C5.5 14.1326 5.44732 14.2598 5.35355 14.3536C5.25979 14.4473 5.13261 14.5 5 14.5H2C1.86739 14.5 1.74021 14.4473 1.64645 14.3536C1.55268 14.2598 1.5 14.1326 1.5 14V11C1.5 10.8674 1.55268 10.7402 1.64645 10.6464C1.74021 10.5527 1.86739 10.5 2 10.5ZM0 11C0 10.4696 0.210714 9.96086 0.585786 9.58579C0.960859 9.21071 1.46957 9 2 9H5C5.53043 9 6.03914 9.21071 6.41421 9.58579C6.78929 9.96086 7 10.4696 7 11V14C7 14.5304 6.78929 15.0391 6.41421 15.4142C6.03914 15.7893 5.53043 16 5 16H2C1.46957 16 0.960859 15.7893 0.585786 15.4142C0.210714 15.0391 0 14.5304 0 14V11Z" fill="white"/></svg>'
					: '<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 0C7.44772 0 7 0.447715 7 1V7H1C0.447715 7 0 7.44771 0 8C0 8.55228 0.447715 9 1 9H7V15C7 15.5523 7.44772 16 8 16C8.55229 16 9 15.5523 9 15V9H15C15.5523 9 16 8.55229 16 8C16 7.44772 15.5523 7 15 7H9V1C9 0.447715 8.55229 0 8 0Z" fill="white"/></svg>',
				)
			);
			?>
			<a class="added-to-cart-btn view-cart" href="<?php brandy_get_cart_page_url(); ?>"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.3 20.6875C13.3 24.7609 16.6141 28.075 20.6875 28.075C24.7609 28.075 28.075 24.7609 28.075 20.6875C28.075 16.6141 24.7609 13.3 20.6875 13.3C16.6141 13.3 13.3 16.6141 13.3 20.6875ZM14.575 20.6875C14.575 17.3168 17.3168 14.575 20.6875 14.575C24.0582 14.575 26.8 17.3168 26.8 20.6875C26.8 24.0582 24.0582 26.8 20.6875 26.8C17.3168 26.8 14.575 24.0582 14.575 20.6875Z" fill="#272829" stroke="#272829" stroke-width="0.15"/><path d="M23.1021 23.9984L23.1024 23.9986C23.2196 24.0916 23.361 24.1375 23.5 24.1375C23.6858 24.1375 23.8722 24.056 23.9974 23.8989L23.9974 23.8988C24.2166 23.6235 24.172 23.2233 23.898 23.0028L23.8978 23.0027L21.325 20.944V17.3125C21.325 16.9606 21.0394 16.675 20.6875 16.675C20.3356 16.675 20.05 16.9606 20.05 17.3125V21.25C20.05 21.444 20.1381 21.6262 20.2894 21.7482L20.2896 21.7484L23.1021 23.9984Z" fill="#272829" stroke="#272829" stroke-width="0.15"/><path d="M2.49175 23.575H11.6875C12.0394 23.575 12.325 23.2894 12.325 22.9375C12.325 22.5856 12.0394 22.3 11.6875 22.3H2.49175C2.33067 22.3 2.2 22.1693 2.2 22.0082V8.95H22.3V11.6875C22.3 12.0394 22.5856 12.325 22.9375 12.325C23.2894 12.325 23.575 12.0394 23.575 11.6875V8.3125C23.575 7.96058 23.2894 7.675 22.9375 7.675H1.5625C1.21058 7.675 0.925 7.96058 0.925 8.3125V22.0082C0.925 22.872 1.62795 23.575 2.49175 23.575Z" fill="#272829" stroke="#272829" stroke-width="0.15"/><path d="M18.9816 2.45256L18.9814 2.4522C18.8968 2.29656 18.7332 2.2 18.5557 2.2H5.9444C5.76696 2.2 5.60317 2.29652 5.51737 2.45252L5.51734 2.45256L2.11988 8.61975L18.9816 2.45256ZM18.9816 2.45256L22.379 8.61968M18.9816 2.45256L22.379 8.61968M1.25416 8.87098L1.25404 8.87091C0.946633 8.70127 0.834485 8.31251 1.00411 8.00514M1.25416 8.87098L1.00411 8.00514M1.25416 8.87098C1.5626 9.04049 1.9502 8.9284 2.11984 8.61981L1.25416 8.87098ZM1.00411 8.00514L4.4015 1.83809M1.00411 8.00514L4.4015 1.83809M23.496 8.00406L23.496 8.00413C23.6655 8.31246 23.5535 8.69989 23.2452 8.86963M23.496 8.00406L23.2448 8.86985C23.2449 8.86978 23.245 8.8697 23.2452 8.86963M23.496 8.00406L20.0985 1.8369C19.7894 1.27394 19.1972 0.925 18.5557 0.925H5.9444C5.30291 0.925 4.71067 1.27392 4.40156 1.83798M23.496 8.00406L4.40156 1.83798M23.2452 8.86963C23.1479 8.92455 23.0419 8.95 22.9375 8.95C22.7134 8.95 22.4952 8.83156 22.3791 8.61981M23.2452 8.86963L22.3791 8.61981M22.3791 8.61981L22.379 8.61968M22.3791 8.61981L22.379 8.61968M4.4015 1.83809C4.40152 1.83805 4.40154 1.83801 4.40156 1.83798M4.4015 1.83809L4.40156 1.83798" fill="#272829" stroke="#272829" stroke-width="0.15"/><path d="M11.6125 8.3125C11.6125 8.66442 11.8981 8.95 12.25 8.95C12.6019 8.95 12.8875 8.66442 12.8875 8.3125V1.5625C12.8875 1.21058 12.6019 0.925 12.25 0.925C11.8981 0.925 11.6125 1.21058 11.6125 1.5625V8.3125Z" fill="#272829" stroke="#272829" stroke-width="0.15"/></svg></a>
		<?php endif ?>
		<?php if ( ! empty( $show_sale_flash ) ) : ?>
		<span class="brandy-sale-tag onsale"><?php esc_html_e( 'Sale!', 'brandy' ); ?></span>
		<?php endif ?>
	</div>
	<?php endif; ?>
	<div class="brandy-loop-product__content">
		<?php if ( ! empty( $display_settings['show_title'] ) ) : ?>
			<div class="brandy-loop-product__title">
				<a href="<?php echo esc_url( $product->get_permalink() ); ?>"><?php echo esc_html( $product->get_title() ); ?></a>
			</div>
		<?php endif; ?>
		<?php if ( ! empty( $show_price ) ) : ?>
		<div class="brandy-loop-product__price price"><?php echo wp_kses_post( $product->get_price_html() ); ?></div>
		<?php endif; ?>
	</div>
</li>
